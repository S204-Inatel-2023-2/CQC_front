{"ast":null,"code":"import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}function _toPropertyKey(arg){var key=_toPrimitive(arg,\"string\");return typeof key===\"symbol\"?key:String(key);}function _toPrimitive(input,hint){if(typeof input!==\"object\"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||\"default\");if(typeof res!==\"object\")return res;throw new TypeError(\"@@toPrimitive must return a primitive value.\");}return(hint===\"string\"?String:Number)(input);}import{runOnUIImmediately}from\"../../threads\";import{registerEventHandler,unregisterEventHandler}from\"../../core\";import Platform from\"react-native-web/dist/exports/Platform\";export var ProgressTransitionManager=function(){function ProgressTransitionManager(){_classCallCheck(this,ProgressTransitionManager);_defineProperty(this,\"_sharedElementCount\",0);_defineProperty(this,\"_eventHandler\",{isRegistered:false,onTransitionProgress:-1,onAppear:-1,onDisappear:-1,onSwipeDismiss:-1});}_createClass(ProgressTransitionManager,[{key:\"addProgressAnimation\",value:function addProgressAnimation(viewTag,progressAnimation){runOnUIImmediately(function(){'worklet';global.ProgressTransitionRegister.addProgressAnimation(viewTag,progressAnimation);})();this.registerEventHandlers();}},{key:\"removeProgressAnimation\",value:function removeProgressAnimation(viewTag){this.unregisterEventHandlers();runOnUIImmediately(function(){'worklet';global.ProgressTransitionRegister.removeProgressAnimation(viewTag);})();}},{key:\"registerEventHandlers\",value:function registerEventHandlers(){this._sharedElementCount++;var eventHandler=this._eventHandler;if(!eventHandler.isRegistered){eventHandler.isRegistered=true;var eventPrefix=Platform.OS==='android'?'on':'top';var lastProgressValue=-1;eventHandler.onTransitionProgress=registerEventHandler(function(event){'worklet';var progress=event.progress;if(progress===lastProgressValue){return;}lastProgressValue=progress;global.ProgressTransitionRegister.frame(progress);},eventPrefix+'TransitionProgress');eventHandler.onAppear=registerEventHandler(function(){'worklet';global.ProgressTransitionRegister.onTransitionEnd();},eventPrefix+'Appear');if(Platform.OS==='android'){eventHandler.onDisappear=registerEventHandler(function(){'worklet';global.ProgressTransitionRegister.onAndroidFinishTransitioning();},'onFinishTransitioning');}else if(Platform.OS==='ios'){eventHandler.onDisappear=registerEventHandler(function(){'worklet';global.ProgressTransitionRegister.onTransitionEnd(true);},'topDisappear');eventHandler.onSwipeDismiss=registerEventHandler(function(){'worklet';global.ProgressTransitionRegister.onTransitionEnd();},'topGestureCancel');}}}},{key:\"unregisterEventHandlers\",value:function unregisterEventHandlers(){this._sharedElementCount--;if(this._sharedElementCount===0){var eventHandler=this._eventHandler;eventHandler.isRegistered=false;if(eventHandler.onTransitionProgress!==-1){unregisterEventHandler(eventHandler.onTransitionProgress);eventHandler.onTransitionProgress=-1;}if(eventHandler.onAppear!==-1){unregisterEventHandler(eventHandler.onAppear);eventHandler.onAppear=-1;}if(eventHandler.onDisappear!==-1){unregisterEventHandler(eventHandler.onDisappear);eventHandler.onDisappear=-1;}if(eventHandler.onSwipeDismiss!==-1){unregisterEventHandler(eventHandler.onSwipeDismiss);eventHandler.onSwipeDismiss=-1;}}}}]);return ProgressTransitionManager;}();function createProgressTransitionRegister(){'worklet';var progressAnimations=new Map();var snapshots=new Map();var currentTransitions=new Set();var toRemove=new Set();var progressTransitionManager={addProgressAnimation:function addProgressAnimation(viewTag,progressAnimation){progressAnimations.set(viewTag,progressAnimation);},removeProgressAnimation:function removeProgressAnimation(viewTag){if(progressAnimations.size>1){toRemove.add(viewTag);}else{progressAnimations.delete(viewTag);}},onTransitionStart:function onTransitionStart(viewTag,snapshot){snapshots.set(viewTag,snapshot);currentTransitions.add(viewTag);progressTransitionManager.frame(0);},frame:function frame(progress){for(var viewTag of currentTransitions){var progressAnimation=progressAnimations.get(viewTag);var snapshot=snapshots.get(viewTag);progressAnimation(viewTag,snapshot,progress);}},onAndroidFinishTransitioning:function onAndroidFinishTransitioning(){if(toRemove.size>0){progressTransitionManager.onTransitionEnd();}},onTransitionEnd:function onTransitionEnd(){var removeViews=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;for(var viewTag of currentTransitions){_notifyAboutEnd(viewTag,removeViews);}currentTransitions.clear();snapshots.clear();if(toRemove.size>0){for(var _viewTag of toRemove){progressAnimations.delete(_viewTag);}toRemove.clear();}}};return progressTransitionManager;}runOnUIImmediately(function(){'worklet';global.ProgressTransitionRegister=createProgressTransitionRegister();})();","map":{"version":3,"names":["runOnUIImmediately","registerEventHandler","unregisterEventHandler","Platform","ProgressTransitionManager","_classCallCheck","_defineProperty","isRegistered","onTransitionProgress","onAppear","onDisappear","onSwipeDismiss","_createClass","key","value","addProgressAnimation","viewTag","progressAnimation","global","ProgressTransitionRegister","registerEventHandlers","removeProgressAnimation","unregisterEventHandlers","_sharedElementCount","eventHandler","_eventHandler","eventPrefix","OS","lastProgressValue","event","progress","frame","onTransitionEnd","onAndroidFinishTransitioning","createProgressTransitionRegister","progressAnimations","Map","snapshots","currentTransitions","Set","toRemove","progressTransitionManager","set","size","add","delete","onTransitionStart","snapshot","get","removeViews","arguments","length","undefined","_notifyAboutEnd","clear"],"sources":["C:\\Users\\Davi\\Desktop\\projeto\\telaLogin\\node_modules\\react-native-reanimated\\lib\\module\\reanimated2\\layoutReanimation\\sharedTransitions\\ProgressTransitionManager.ts"],"sourcesContent":["import { runOnUIImmediately } from '../../threads';\nimport type { ProgressAnimation } from '../animationBuilder/commonTypes';\nimport { registerEventHandler, unregisterEventHandler } from '../../core';\nimport { Platform } from 'react-native';\n\ntype TransitionProgressEvent = {\n  closing: number;\n  goingForward: number;\n  eventName: string;\n  progress: number;\n  target: number;\n};\n\nexport class ProgressTransitionManager {\n  private _sharedElementCount = 0;\n  private _eventHandler = {\n    isRegistered: false,\n    onTransitionProgress: -1,\n    onAppear: -1,\n    onDisappear: -1,\n    onSwipeDismiss: -1,\n  };\n\n  public addProgressAnimation(\n    viewTag: number,\n    progressAnimation: ProgressAnimation\n  ) {\n    runOnUIImmediately(() => {\n      'worklet';\n      global.ProgressTransitionRegister.addProgressAnimation(\n        viewTag,\n        progressAnimation\n      );\n    })();\n    this.registerEventHandlers();\n  }\n\n  public removeProgressAnimation(viewTag: number) {\n    this.unregisterEventHandlers();\n    runOnUIImmediately(() => {\n      'worklet';\n      global.ProgressTransitionRegister.removeProgressAnimation(viewTag);\n    })();\n  }\n\n  private registerEventHandlers() {\n    this._sharedElementCount++;\n    const eventHandler = this._eventHandler;\n    if (!eventHandler.isRegistered) {\n      eventHandler.isRegistered = true;\n      const eventPrefix = Platform.OS === 'android' ? 'on' : 'top';\n      let lastProgressValue = -1;\n      eventHandler.onTransitionProgress = registerEventHandler(\n        (event: TransitionProgressEvent) => {\n          'worklet';\n          const progress = event.progress;\n          if (progress === lastProgressValue) {\n            // During screen transition, handler receives two events with the same progress\n            // value for both screens, but for modals, there is only one event. To optimize\n            // performance and avoid unnecessary worklet calls, let's skip the second event.\n            return;\n          }\n          lastProgressValue = progress;\n          global.ProgressTransitionRegister.frame(progress);\n        },\n        eventPrefix + 'TransitionProgress'\n      );\n      eventHandler.onAppear = registerEventHandler(() => {\n        'worklet';\n        global.ProgressTransitionRegister.onTransitionEnd();\n      }, eventPrefix + 'Appear');\n\n      if (Platform.OS === 'android') {\n        // onFinishTransitioning event is available only on Android and\n        // is used to handle closing modals\n        eventHandler.onDisappear = registerEventHandler(() => {\n          'worklet';\n          global.ProgressTransitionRegister.onAndroidFinishTransitioning();\n        }, 'onFinishTransitioning');\n      } else if (Platform.OS === 'ios') {\n        // topDisappear event is required to handle closing modals on iOS\n        eventHandler.onDisappear = registerEventHandler(() => {\n          'worklet';\n          global.ProgressTransitionRegister.onTransitionEnd(true);\n        }, 'topDisappear');\n        eventHandler.onSwipeDismiss = registerEventHandler(() => {\n          'worklet';\n          global.ProgressTransitionRegister.onTransitionEnd();\n        }, 'topGestureCancel');\n      }\n    }\n  }\n\n  private unregisterEventHandlers(): void {\n    this._sharedElementCount--;\n    if (this._sharedElementCount === 0) {\n      const eventHandler = this._eventHandler;\n      eventHandler.isRegistered = false;\n      if (eventHandler.onTransitionProgress !== -1) {\n        unregisterEventHandler(eventHandler.onTransitionProgress);\n        eventHandler.onTransitionProgress = -1;\n      }\n      if (eventHandler.onAppear !== -1) {\n        unregisterEventHandler(eventHandler.onAppear);\n        eventHandler.onAppear = -1;\n      }\n      if (eventHandler.onDisappear !== -1) {\n        unregisterEventHandler(eventHandler.onDisappear);\n        eventHandler.onDisappear = -1;\n      }\n      if (eventHandler.onSwipeDismiss !== -1) {\n        unregisterEventHandler(eventHandler.onSwipeDismiss);\n        eventHandler.onSwipeDismiss = -1;\n      }\n    }\n  }\n}\n\nfunction createProgressTransitionRegister() {\n  'worklet';\n  const progressAnimations = new Map<number, ProgressAnimation>();\n  const snapshots = new Map<number, any>();\n  const currentTransitions = new Set<number>();\n  const toRemove = new Set<number>();\n\n  const progressTransitionManager = {\n    addProgressAnimation: (\n      viewTag: number,\n      progressAnimation: ProgressAnimation\n    ) => {\n      progressAnimations.set(viewTag, progressAnimation);\n    },\n    removeProgressAnimation: (viewTag: number) => {\n      if (progressAnimations.size > 1) {\n        // Remove the animation config after the transition is finished\n        toRemove.add(viewTag);\n      } else {\n        progressAnimations.delete(viewTag);\n      }\n    },\n    onTransitionStart: (viewTag: number, snapshot: any) => {\n      snapshots.set(viewTag, snapshot);\n      currentTransitions.add(viewTag);\n      // set initial style for re-parented components\n      progressTransitionManager.frame(0);\n    },\n    frame: (progress: number) => {\n      for (const viewTag of currentTransitions) {\n        const progressAnimation = progressAnimations.get(viewTag);\n        const snapshot = snapshots.get(viewTag);\n        progressAnimation!(viewTag, snapshot, progress);\n      }\n    },\n    onAndroidFinishTransitioning: () => {\n      if (toRemove.size > 0) {\n        // it should be ran only on modal closing\n        progressTransitionManager.onTransitionEnd();\n      }\n    },\n    onTransitionEnd: (removeViews = false) => {\n      for (const viewTag of currentTransitions) {\n        _notifyAboutEnd(viewTag, removeViews);\n      }\n      currentTransitions.clear();\n      snapshots.clear();\n      if (toRemove.size > 0) {\n        for (const viewTag of toRemove) {\n          progressAnimations.delete(viewTag);\n        }\n        toRemove.clear();\n      }\n    },\n  };\n  return progressTransitionManager;\n}\n\nrunOnUIImmediately(() => {\n  'worklet';\n  global.ProgressTransitionRegister = createProgressTransitionRegister();\n})();\n\nexport type ProgressTransitionRegister = ReturnType<\n  typeof createProgressTransitionRegister\n>;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}